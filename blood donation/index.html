<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blood Donation Management</title>
<style>
body {font-family: Arial, sans-serif; margin:0; background:#f5f5f5;}
header {background:#b30000; color:#fff; padding:1rem; text-align:center;}
main {padding:2rem;}
.hidden {display:none;}
input, select, button {width:100%; padding:0.5rem; margin-top:0.5rem; box-sizing:border-box;}
button {background:#b30000; color:#fff; border:none; cursor:pointer;}
ul {list-style:none; padding:0; margin-top:1rem;}
li {background:#eee; padding:0.5rem; border-radius:4px; margin-top:0.5rem;}
nav button {margin:0.5rem; padding:0.5rem 1rem;}
h3 {margin-top:1rem;}
</style>
</head>
<body>
<header><h1>Blood Donation Management</h1></header>
<main>
  <!-- Login Selection -->
  <div id="loginSelection">
    <h2>Login as:</h2>
    <nav>
      <button onclick="showLogin('admin')">Admin</button>
      <button onclick="showLogin('donor')">Donor</button>
      <button onclick="showLogin('receiver')">Receiver</button>
    </nav>
  </div>

  <!-- Admin Login -->
  <div id="adminLogin" class="hidden">
    <h2>Admin Login</h2>
    <input type="text" id="adminUser" placeholder="Username">
    <input type="password" id="adminPass" placeholder="Password">
    <button onclick="loginAdmin()">Login</button>
    <p id="adminMsg" style="color:red;"></p>
    <button onclick="backToSelection()">Back</button>
  </div>

  <!-- Donor Form -->
  <div id="donorFormDiv" class="hidden">
    <h2>Donor Registration</h2>
    <input type="text" id="donorName" placeholder="Name">
    <input type="number" id="donorAge" placeholder="Age">
    <input type="text" id="donorCity" placeholder="City">
    <input type="text" id="donorHospital" placeholder="Hospital">
    <input type="text" id="donorPhone" placeholder="Phone Number">
    <select id="donorBloodGroup">
      <option value="">Select Blood Group</option>
      <option>A+</option><option>A-</option>
      <option>B+</option><option>B-</option>
      <option>O+</option><option>O-</option>
      <option>AB+</option><option>AB-</option>
    </select>
    <button onclick="addDonor()">Add Donor</button>
    <p id="donorMsg" style="color:green;"></p>
    <button onclick="backToSelection()">Back</button>
  </div>

  <!-- Receiver Form -->
  <div id="receiverFormDiv" class="hidden">
    <h2>Receiver Details</h2>
    <input type="text" id="receiverName" placeholder="Name">
    <input type="text" id="receiverCity" placeholder="City">
    <input type="text" id="receiverPhone" placeholder="Phone Number">
    <select id="receiverBloodGroup">
      <option value="">Select Required Blood Group</option>
      <option>A+</option><option>A-</option>
      <option>B+</option><option>B-</option>
      <option>O+</option><option>O-</option>
      <option>AB+</option><option>AB-</option>
    </select>
    <button onclick="submitReceiver()">Submit Request</button>
    <p id="receiverMsg" style="color:green;"></p>
    <h3>Matching Donors</h3>
    <ul id="matchedDonors"></ul>
    <button onclick="backToSelection()">Back</button>
  </div>

  <!-- Admin Dashboard -->
  <div id="adminDashboard" class="hidden">
    <h2>All Donors</h2>
    <ul id="allDonors"></ul>
    <h2>All Receivers</h2>
    <ul id="allReceivers"></ul>
    <button onclick="logout()">Logout</button>
  </div>
</main>

<script>
function showLogin(type){
  document.getElementById('loginSelection').classList.add('hidden');
  if(type==='admin') document.getElementById('adminLogin').classList.remove('hidden');
  if(type==='donor') document.getElementById('donorFormDiv').classList.remove('hidden');
  if(type==='receiver') document.getElementById('receiverFormDiv').classList.remove('hidden');
}
function backToSelection(){
  document.querySelectorAll('div[id$="Div"], #adminLogin, #adminDashboard').forEach(d=>d.classList.add('hidden'));
  document.getElementById('loginSelection').classList.remove('hidden');
}

function loginAdmin(){
  const u = document.getElementById('adminUser').value;
  const p = document.getElementById('adminPass').value;
  if(u==='AIML' && p==='1234'){
    document.getElementById('adminLogin').classList.add('hidden');
    document.getElementById('adminDashboard').classList.remove('hidden');
    showAllDonors();
    showAllReceivers();
  } else document.getElementById('adminMsg').textContent='Invalid credentials';
}
function logout(){ backToSelection(); }

let donors = JSON.parse(localStorage.getItem('donorsData')) || [];
let receivers = JSON.parse(localStorage.getItem('receiversData')) || [];

function addDonor(){
  const donor = {
    name: document.getElementById('donorName').value,
    age: document.getElementById('donorAge').value,
    city: document.getElementById('donorCity').value,
    hospital: document.getElementById('donorHospital').value,
    phone: document.getElementById('donorPhone').value,
    blood: document.getElementById('donorBloodGroup').value
  };
  if(!donor.name || !donor.age || !donor.city || !donor.hospital || !donor.phone || !donor.blood){
    document.getElementById('donorMsg').textContent='Fill all fields!';
    return;
  }
  donors.push(donor);
  localStorage.setItem('donorsData', JSON.stringify(donors));
  document.getElementById('donorMsg').textContent='Donor added successfully!';
  document.querySelectorAll('#donorFormDiv input, #donorFormDiv select').forEach(i=>i.value='');
}

function submitReceiver(){
  const receiver = {
    name: document.getElementById('receiverName').value,
    city: document.getElementById('receiverCity').value,
    phone: document.getElementById('receiverPhone').value,
    blood: document.getElementById('receiverBloodGroup').value
  };
  if(!receiver.name || !receiver.city || !receiver.phone || !receiver.blood){
    document.getElementById('receiverMsg').textContent='Fill all fields!';
    return;
  }
  receivers.push(receiver);
  localStorage.setItem('receiversData', JSON.stringify(receivers));
  document.getElementById('receiverMsg').textContent='Request submitted!';
  document.querySelectorAll('#receiverFormDiv input, #receiverFormDiv select').forEach(i=>i.value='');
  showMatchingDonors(receiver.blood);
}

function showMatchingDonors(blood){
  const list = document.getElementById('matchedDonors');
  list.innerHTML='';
  const matched = donors.filter(d=>d.blood===blood);
  if(matched.length===0) list.innerHTML='<li>No matching donors found.</li>';
  else matched.forEach(d=>{
    const li = document.createElement('li');
    li.textContent=${d.name} - ${d.city}, ${d.hospital}, Phone: ${d.phone};
    list.appendChild(li);
  });
}

function showAllDonors(){
  const list = document.getElementById('allDonors');
  list.innerHTML='';
  if(donors.length===0) list.innerHTML='<li>No donors registered yet.</li>';
  else donors.forEach((d,i)=>{
    const li = document.createElement('li');
    li.innerHTML=${i+1}. ${d.name} (${d.blood}) - ${d.city}, ${d.hospital}, Phone: ${d.phone} <button onclick="deleteDonor(${i})">Delete</button>;
    list.appendChild(li);
  });
}

function showAllReceivers(){
  const list = document.getElementById('allReceivers');
  list.innerHTML='';
  if(receivers.length===0) list.innerHTML='<li>No receiver requests yet.</li>';
  else receivers.forEach((r,i)=>{
    const li = document.createElement('li');
    li.innerHTML=${i+1}. ${r.name} (${r.blood}) - ${r.city}, Phone: ${r.phone} <button onclick="deleteReceiver(${i})">Delete</button>;
    list.appendChild(li);
  });
}

function deleteDonor(index){
  donors.splice(index,1);
  localStorage.setItem('donorsData', JSON.stringify(donors));
  showAllDonors();
}

function deleteReceiver(index){
  receivers.splice(index,1);
  localStorage.setItem('receiversData', JSON.stringify(receivers));
  showAllReceivers();
}
</script>
</body>
</html>